"use strict";(self["webpackJsonp_basics"]=self["webpackJsonp_basics"]||[]).push([[841],{340:function(e,t,a){a.d(t,{Z:function(){return c}});var l=function(){var e=this,t=e._self._c;return t("div",{staticClass:"table-content"},[t("el-table",{ref:"table",attrs:{data:e.table.tableData.slice((e.currentPage-1)*e.pageSize,e.currentPage*e.pageSize),"empty-text":"暂无数据~",border:"",height:e.tableHeightComputed}},[e._l(e.table.header,(function(a,l){return[a.selection?[t("el-table-column",{key:l,attrs:{type:"selection",width:a.width,"min-width":a.minWidth,align:"center"}})]:a.dia?[t("el-table-column",{key:l,attrs:{prop:a.prop,label:a.label,width:a.width,fixed:a.fixed,"min-width":a.minWidth,align:"center"},scopedSlots:e._u([{key:"default",fn:function(l){return e._l(a.tableOption,(function(i,s){return t("el-button",{key:s,attrs:{type:i.type},on:{click:function(t){return e.openDia(i.methods,l.row[a.prop])}}},[e._v(" "+e._s(i.label)+" ")])}))}}],null,!0)})]:a.status?t("el-table-column",{key:l,attrs:{prop:a.prop,label:a.label,"min-width":a.minWidth,width:a.width,fixed:a.fixed,align:"center"},scopedSlots:e._u([{key:"default",fn:function(l){return[t("span",[e._v(e._s(e._f("changeStatus")(l.row[a.prop],a.filters)))])]}}],null,!0)}):a.color?[t("el-table-column",{key:l,attrs:{prop:a.prop,label:a.label,"min-width":a.minWidth,width:a.width,fixed:a.fixed,align:"center"},scopedSlots:e._u([{key:"default",fn:function(l){return[t("div",{style:`background-color:${l.row[a.prop]};`},[e._v(" "+e._s(l.row[a.prop])+" ")])]}}],null,!0)})]:a.colorBtn?[t("el-table-column",{key:l,attrs:{prop:a.prop,label:a.label,"min-width":a.minWidth,width:a.width,fixed:a.fixed,align:"center"},scopedSlots:e._u([{key:"default",fn:function(l){return e._l(a.tableOption,(function(i,s){return t("el-button",{key:s,attrs:{round:i.round,type:e.changeType(l.row[a.prop],i.filters),size:i.size}},[e._v(e._s(e._f("changeStatus")(l.row[a.prop],a.filters)))])}))}}],null,!0)})]:a.control?[t("el-table-column",{key:l,attrs:{prop:a.prop,label:a.label,"min-width":a.minWidth,width:a.width,fixed:a.fixed,align:"center","class-name":"right-fixed"},scopedSlots:e._u([{key:"default",fn:function(l){return e._l(a.tableOption,(function(a,i){return t("el-button",{key:i,staticClass:"right-fixed right-btn",attrs:{type:a.type,size:a.size},on:{click:function(t){return e.handButton(a.methods,l.row,l.$index)}}},[e._v(" "+e._s(a.label)+" ")])}))}}],null,!0)})]:[t("el-table-column",{key:l,attrs:{prop:a.prop,label:a.label,"min-width":a.minWidth,width:a.width,fixed:a.fixed,align:"center"}})]]}))],2)],1)},i=[],s={props:{table:{type:Object,required:!0},pageSize:{type:Number,default:10},currentPage:{type:Number,default:1}},data(){return{itemHeaderHeight:"",tableHeight:""}},filters:{changeStatus(e,t){return"function"===typeof t?t(e):e}},computed:{tableHeightComputed(){return this.tableHeight-this.itemHeaderHeight}},watch:{itemHeaderHeight(){this.resize()}},mounted(){addEventListener("resize",this.resize)},beforeDestroy(){removeEventListener("resize",this.resize)},created(){this.$nextTick((()=>{let e=document.documentElement.clientHeight,t=this.$refs.table.$el.getBoundingClientRect().top;this.tableHeight=e-t-60,console.log(e,t,this.tableHeightC,"itemheightbheight")}))},methods:{resize(){let e=document.documentElement.clientHeight,t=this.$refs.table.$el.getBoundingClientRect().top;this.tableHeight=e-t-60},handButton(e,t,a){this.$emit("handButton",{methods:e,row:t,index:a})},openDia(e,t){this.$emit("openDia",t)},changeType(e,t){return"function"===typeof t?t(e):e}}},o=s,n=a(1001),r=(0,n.Z)(o,l,i,!1,null,null,null),c=r.exports},7841:function(e,t,a){a.r(t),a.d(t,{default:function(){return k}});var l=function(){var e=this,t=e._self._c;return t("div",{staticClass:"user-control"},[e._m(0),t("div",{ref:"itemHeader",staticClass:"user-control-nav"},[t("div",{staticClass:"table-control-search"},[t("el-form",{ref:"searchFrom",attrs:{model:e.searchFrom,inline:"",size:"mini"}},[t("div",{staticClass:"search-left"},[t("el-form-item",{attrs:{prop:"userId",label:"员工工号："}},[t("el-input",{model:{value:e.searchFrom.userId,callback:function(t){e.$set(e.searchFrom,"userId",t)},expression:"searchFrom.userId"}})],1),t("el-form-item",{attrs:{prop:"searchName",label:"员工名称："}},[t("el-input",{model:{value:e.searchFrom.searchName,callback:function(t){e.$set(e.searchFrom,"searchName",t)},expression:"searchFrom.searchName"}})],1),t("el-form-item",{attrs:{prop:"searchPhone",label:"手机号码："}},[t("el-input",{model:{value:e.searchFrom.searchPhone,callback:function(t){e.$set(e.searchFrom,"searchPhone",t)},expression:"searchFrom.searchPhone"}})],1),t("el-form-item",{attrs:{label:"绑定状态",prop:"searchRegion"}},[t("el-select",{attrs:{placeholder:"请选择状态","popper-append-to-body":!1},model:{value:e.searchFrom.searchRegion,callback:function(t){e.$set(e.searchFrom,"searchRegion",t)},expression:"searchFrom.searchRegion"}},e._l(e.select,(function(e){return t("el-option",{key:e.id,attrs:{label:e.label,value:e.value}})})),1)],1),t("el-form-item",{attrs:{label:"选择机构:",prop:"checkMana"}},[t("el-input",{attrs:{disabled:""},nativeOn:{click:function(t){e.selectDialogVisible=!0}},model:{value:e.searchFrom.checkMana,callback:function(t){e.$set(e.searchFrom,"checkMana",t)},expression:"searchFrom.checkMana"}})],1)],1),t("div",{staticClass:"search-right"},[t("el-form-item",[t("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.searchFromData(e.searchFrom)}}},[e._v("查询")])],1),t("el-form-item",[t("el-button",{staticClass:"reset",attrs:{type:"primary",size:"small"},on:{click:function(t){return e.resetForm("searchFrom")}}},[e._v("重置")])],1)],1)])],1)]),t("div",{staticClass:"table-control-main"},[t("div",{staticClass:"m_text"},[t("p",[e._v("员工列表")]),t("div",{staticClass:"user-control-btn"},[t("div",[t("NewStaff")],1)])]),t("TableComponentVue",{ref:"table",attrs:{table:e.table},on:{handButton:e.handButton}}),t("div",{ref:"block",staticClass:"block"},[t("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.table.tableData.length},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),t("el-dialog",{attrs:{title:e.title,visible:e.viewDialogVisible,width:"40%"},on:{"update:visible":function(t){e.viewDialogVisible=t}}},[t("div",[t("el-form",{ref:"changeTempData",attrs:{model:e.viewTempData}},[t("el-form-item",{attrs:{label:"用户编号","label-width":e.formLabelWidth,prop:"user_code"}},[t("el-input",{attrs:{autocomplete:"off",disabled:e.disabled},model:{value:e.viewTempData.user_code,callback:function(t){e.$set(e.viewTempData,"user_code",t)},expression:"viewTempData.user_code"}})],1),t("el-form-item",{attrs:{label:"用户名称","label-width":e.formLabelWidth,prop:"user_name"}},[t("el-input",{attrs:{disabled:e.disabled,autocomplete:"off"},model:{value:e.viewTempData.user_name,callback:function(t){e.$set(e.viewTempData,"user_name",t)},expression:"viewTempData.user_name"}})],1),t("el-form-item",{attrs:{label:"归属机构","label-width":e.formLabelWidth,prop:"dept_name"}},["修改员工"===e.title?t("el-select",{attrs:{placeholder:"请选择状态","popper-append-to-body":!1},model:{value:e.viewTempData.dept_name,callback:function(t){e.$set(e.viewTempData,"dept_name",t)},expression:"viewTempData.dept_name"}},[t("el-option",{attrs:{label:"归属机构1",value:"归属机构1"}}),t("el-option",{attrs:{label:"归属机构2",value:"归属机构2"}}),t("el-option",{attrs:{label:"归属机构3",value:"归属机构3"}})],1):t("el-input",{attrs:{autocomplete:"off",disabled:e.disabled},model:{value:e.viewTempData.dept_name,callback:function(t){e.$set(e.viewTempData,"dept_name",t)},expression:"viewTempData.dept_name"}})],1),t("el-form-item",{attrs:{label:"状态","label-width":e.formLabelWidth,prop:"status"}},[t("el-radio",{attrs:{disabled:e.disabled,label:0},model:{value:e.viewTempData.status,callback:function(t){e.$set(e.viewTempData,"status",t)},expression:"viewTempData.status"}},[e._v("无效")]),t("el-radio",{attrs:{disabled:e.disabled,label:1},model:{value:e.viewTempData.status,callback:function(t){e.$set(e.viewTempData,"status",t)},expression:"viewTempData.status"}},[e._v("有效")])],1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"info"},on:{click:function(t){e.viewDialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.viewDialogVisible=!1}}},[e._v("确 定")])],1)]),t("el-dialog",{attrs:{title:"选择机构",visible:e.selectDialogVisible,width:"30%"},on:{"update:visible":function(t){e.selectDialogVisible=t}}},[t("div",{staticClass:"content"},e._l(e.selectManaData,(function(a){return t("p",{key:a.dept_code,on:{click:function(t){return e.checkManaData(a)}}},[e._v(" "+e._s(a.dept_name)+" ")])})),0),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"info"},on:{click:function(t){e.selectDialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.selectDialogVisible=!1}}},[e._v("确 定")])],1)]),t("el-dialog",{attrs:{title:"授权提示",visible:e.powerDialogVisible,width:"30%"},on:{"update:visible":function(t){e.powerDialogVisible=t}}},[t("div",{staticClass:"content"},[e._v(" 用户授权 "),t("el-tree",{attrs:{"show-checkbox":"","node-key":"id",data:e.menuData,props:e.defaultProps}})],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"info"},on:{click:function(t){e.powerDialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.powerDialogVisible=!1}}},[e._v("确 定")])],1)])],1)},i=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"search-control-header"},[t("p",[e._v("查询条件")])])}],s=(a(6699),function(){var e=this,t=e._self._c;return t("div",{staticStyle:{display:"inline-block","margin-right":"10px"}},[t("el-button",{attrs:{icon:"el-icon-plus",size:"small"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("新增员工")]),t("el-dialog",{attrs:{title:"基本信息",visible:e.dialogFormVisible,"before-close":e.handleClose},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[t("el-form",{ref:"newStaffForm",attrs:{model:e.newStaffForm,rules:e.newStaffRules}},[t("el-form-item",{attrs:{label:"用户编号","label-width":e.formLabelWidth,prop:"id"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.newStaffForm.id,callback:function(t){e.$set(e.newStaffForm,"id",t)},expression:"newStaffForm.id"}})],1),t("el-form-item",{attrs:{label:"用户名称","label-width":e.formLabelWidth,prop:"nickname"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.newStaffForm.nickname,callback:function(t){e.$set(e.newStaffForm,"nickname",t)},expression:"newStaffForm.nickname"}})],1),t("el-form-item",{attrs:{label:"机构编号","label-width":e.formLabelWidth,prop:"qyid"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.newStaffForm.qyid,callback:function(t){e.$set(e.newStaffForm,"qyid",t)},expression:"newStaffForm.qyid"}})],1),t("el-form-item",{attrs:{label:"归属机构","label-width":e.formLabelWidth,prop:"addres"}},[t("el-input",{attrs:{autocomplete:"off"},nativeOn:{click:function(t){e.selectDialogVisible=!0}},model:{value:e.newStaffForm.addres,callback:function(t){e.$set(e.newStaffForm,"addres",t)},expression:"newStaffForm.addres"}})],1),t("el-form-item",{attrs:{label:"手机号码","label-width":e.formLabelWidth,prop:"Mobile"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.newStaffForm.Mobile,callback:function(t){e.$set(e.newStaffForm,"Mobile",t)},expression:"newStaffForm.Mobile"}})],1),t("el-form-item",{attrs:{label:"状态","label-width":e.formLabelWidth,prop:"zt"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择状态","popper-append-to-body":!1},model:{value:e.newStaffForm.zt,callback:function(t){e.$set(e.newStaffForm,"zt",t)},expression:"newStaffForm.zt"}},[t("el-option",{attrs:{label:"有效",value:1}}),t("el-option",{attrs:{label:"无效",value:0}})],1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"info"},on:{click:function(t){e.dialogFormVisible=!1,e.resetNewStaff()}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitNewStaff("newStaffForm")}}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"选择机构",visible:e.selectDialogVisible,width:"30%"},on:{"update:visible":function(t){e.selectDialogVisible=t}}},[t("div",{staticClass:"content"},e._l(e.selectManaData,(function(a){return t("p",{key:a.dept_code,on:{click:function(t){return e.checkManaData(a)}}},[e._v(" "+e._s(a.dept_name)+" ")])})),0),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"info"},on:{click:function(t){e.selectDialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.selectDialogVisible=!1}}},[e._v("确 定")])],1)])],1)}),o=[],n={computed:{aaa(){return console.log(this.$store.state),this.$store.state.newStaff.num}},data(){return{dialogFormVisible:!1,selectManaData:"",selectDialogVisible:!1,newStaffForm:{id:"",nickname:"",zt:"",qyid:"",addres:"",Mobile:""},formLabelWidth:"120px",newStaffRules:{id:[{required:!0,message:"请输入工号",trigger:"blur"}],nickname:[{required:!0,message:"请输入名字",trigger:"blur"}],zt:[{required:!0,message:"请选择状态",trigger:"blur"}],qyid:[{required:!0,message:"请输入机构编号",trigger:"blur"}],addres:[{required:!0,message:"请输入地址",trigger:"blur"}]}}},created(){this.getTableDataDept(this.getdept,"dept_name","dept_code")},methods:{checkManaData(e){this.newStaffForm.addres=e.dept_name,this.newStaffForm.qyid=e.dept_code,this.$message({type:"success",message:`已选择${e.dept_name}`})},getTableDataDept(e,t,a){t=t||"dept_name",a=a||"dept_code";let l=[];e&&e.forEach((e=>{const i={dept_code:e[a],dept_name:e[t]};l.push(i)}));var i={};function s(){return l=l.reduce((function(e,t){return!i[t.dept_name]&&(i[t.dept_name]=e.push(t)),e}),[]),l}let o=s();return this.selectManaData=o,l},handleClose(e){this.$confirm("确认关闭？").then((t=>{console.log(t),this.resetNewStaff(),e()})).catch((e=>{console.log(e),this.$message({message:"已取消"})}))},submitNewStaff(e){this.$refs[e].validate((e=>{if(!e)return!1;{let e={user_code:this.newStaffForm.id,user_name:this.newStaffForm.nickname,status:this.newStaffForm.zt,dept_code:this.newStaffForm.qyid,dept_name:this.newStaffForm.addres,telephone:this.newStaffForm.Mobile,isNo:Math.floor(2*Math.random())};this.resetNewStaff(),console.log(e),this.$store.commit("newStaff/add_unshift",e),this.dialogFormVisible=!1}}))},resetNewStaff(){this.$refs.newStaffForm.resetFields()}}},r=n,c=a(1001),d=(0,c.Z)(r,s,o,!1,null,null,null),p=d.exports,u=a(340);let m={tableData:[],header:[{prop:"user_code",label:"员工工号",minWidth:"120px"},{prop:"user_name",label:"用户姓名",minWidth:"110px"},{prop:"status",label:"用户状态",minWidth:"110px",status:!0,filters:e=>0==e?"无效":"有效"},{prop:"dept_code",label:"机构编号",minWidth:"120px"},{prop:"telephone",label:"手机号码",minWidth:"120px"},{prop:"isNo",label:"是否绑定",status:!0,minWidth:"110px",filters:e=>0==e?"未绑定":"已绑定"},{prop:"",label:"操作",control:!0,fixed:"right",minWidth:"300px",tableOption:[{type:"text",label:"授权",size:"mini",methods:"powerClick"},{type:"text",label:"查看",size:"mini",methods:"handleClickSee"},{type:"text",label:"修改",size:"mini",methods:"handleClickChange"},{type:"text",label:"删除",size:"mini",methods:"deleteRow"},{type:"text",label:"微信解绑",size:"mini",methods:"unbindWechat"}]}]};var h=m,f=a(2373),b=a(4471);function g(){return(0,b.Z)({method:"get",url:"/api/healthPlat/getRecipe"})}var w={components:{NewStaff:p,TableComponentVue:u.Z},data(){return{fullscreen:!1,currentPage:1,pageSize:10,dialogFormVisible:!1,searchFrom:{searchRegion:"",searchName:"",searchPhone:"",userId:"",checkMana:""},searchData:[],formLabelWidth:"120px",viewDialogVisible:!1,viewTempData:{},select:[{id:1,label:"全部",value:""},{id:2,label:"已绑定",value:"1"},{id:3,label:"未绑定",value:"0"}],selectManaData:"",selectDialogVisible:!1,powerDialogVisible:!1,menuData:[],defaultProps:{children:"children",label:"menu_name"},table:h,disabled:!1,title:""}},created(){this.searchFrom.searchRegion=this.select[0].value,this.getData(),console.log(this.menuData),this.getSider()},destroyed(){window.onresize=null},methods:{bindClick(){this.$refs.table.$el.requestFullscreen()},getSider(){(0,f.u)().then((e=>{this.menuData=e.data.data[0].user_Menu,console.log(e.data.data[0].user_Menu,"resresres")})).catch((e=>console.log(e)))},checkManaData(e){this.searchFrom.checkMana=e.dept_name},getTableDataDept(e,t,a){t=t||"dept_name",a=a||"dept_code";let l=[];e&&e.forEach((e=>{const i={dept_code:e[a],dept_name:e[t]};l.push(i)}));var i={};function s(){return l=l.reduce((function(e,t){return!i[t.dept_name]&&(i[t.dept_name]=e.push(t)),e}),[]),l}let o=s();return this.selectManaData=o,l},searchFromData({searchRegion:e,searchName:t,searchPhone:a,userId:l,checkMana:i}){let s=this.searchData.filter((s=>{let o=!0,n=!0,r=!0,c=!0,d=!0;return a&&(r=s.telephone.includes(a)),e&&(o=s.isNo==e),l&&(c=s.user_code.includes(l)),i&&(d=s.dept_name.includes(i)),t&&(n=s.user_name.includes(t)),n&&o&&r&&c&&d}));console.log(s),this.table["tableData"]=s},resetForm(e){this.$refs[e].resetFields(),this.table["tableData"]=this.searchData},handButton(e){"powerClick"===e.methods?this.powerClick():"deleteRow"===e.methods?this.deleteRow(e.index,this.table.tableData,e.row):"handleClickChange"===e.methods?this.handleClickChange(e.row):"handleClickSee"===e.methods&&this.handleClickSee(e.row)},powerClick(){this.powerDialogVisible=!0},deleteRow(e,t,a){console.log(a);const l=this.$createElement;this.$msgbox({title:"提示",type:"warning",message:l("p",null,[l("span",null,"已选择"),l("span",{style:"color: red"},` ${a.user_name}`),l("span",null," ! 此操作将永久删除该数据, 是否继续?")]),showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消"}).then((()=>{t.splice(e,1),this.$message({type:"success",message:"删除成功!"})})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},handleClickChange(e){let t="修改员工";this.viewChange(t,!1,e),console.log(e,"handleClickChange")},handleClickSee(e){let t="查看员工";this.viewChange(t,!0,e),console.log(e,"handleClickSee")},viewChange(e,t,a){this.viewTempData=a,this.viewDialogVisible=!0,this.title=e,this.disabled=t},getData(){g().then((e=>{this.table.tableData=e.data.data,this.searchData=e.data.data,this.getTableDataDept(e.data.data,"dept_name","dept_code")})).catch((e=>console.log(e)))},handleSizeChange(e){this.pageSize=e},handleCurrentChange(e){this.currentPage=e}}},v=w,_=(0,c.Z)(v,l,i,!1,null,"5553e07f",null),k=_.exports}}]);